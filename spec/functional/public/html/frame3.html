<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
  </head>
  <body>
    frame3.html
    <input id="polo-text" placeholder="Marco reply" /><br />

    <input id="popup-message" />
    <button id="send">Send popup a message</button>

    <br />
    <hr />

    <button id="send-to-parent">
      Send a targetted message to only the parent frame
    </button>

    <script src="/js/test-app.js"></script>
    <script>
      var bus = new Framebus();

      document.querySelector("#send").addEventListener("click", function () {
        bus.emit("message", {
          message: document.querySelector("#popup-message").value,
        });
      });

      document
        .querySelector("#send-to-parent")
        .addEventListener("click", function () {
          bus
            .target({
              targetFrames: [window.parent],
            })
            .emit("special-message-to-parent", {
              message: "Special targetted message to only parent.",
            });
        });

      bus.on("Marco", function (data, reply) {
        var polo = document.getElementById("polo-text").value;
        app.printToDOM(data.message);
        reply({
          message: polo,
        });
      });

      bus.on("special-message-to-parent", function (payload) {
        app.printToDOM('FAIL: [frame 3] received "' + payload.message + '"');
      });
    </script>
  </body>
</html>
